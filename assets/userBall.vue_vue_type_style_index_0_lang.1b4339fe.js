import{d as Z,r as I,b as Y,m as oe,P as _e,o as w,e as M,f as a,t as j,k as r,n as Fe,T as ge,a as Ee,A as R,s as G,w as B,g as E,U as Ae,V as X,W as ee,X as se,Y as ne,Z as De,R as Ie,E as N,p as ke,j as $e,q as Se,l as L,v as me,F as Be,H as Pe,_ as Me,u as Ve,z as Ne,B as Ue,$ as Te,i as pe,a0 as ye,S as Re}from"./index.bc555423.js";import{r as Le,a as Oe,S as Ge,m as ae,b as ie,t as We,F as qe,R as je,_ as Je}from"./myGame.6e9a1829.js";import{_ as we}from"./_plugin-vue_export-helper.cdc0426e.js";import{u as fe,l as ue,o as le}from"./source.4b31753f.js";import{a as He,r as Xe}from"./format.4b9e5d75.js";const Ce=[[["zombie-flag","zombie-1","zombie-1","zombie-1","zombie-2","zombie-2","zombie-2","zombie-3","zombie-3","zombie-3"],["zombie-flag","zombie-3","zombie-3","zombie-1","zombie-1","zombie-1","zombie-2","zombie-2","zombie-3","zombie-3","iron-gate"],["zombie-flag","iron-gate","zombie-1","zombie-1","zombie-2","zombie-2","zombie-3","zombie-3","zombie-3","iron-gate","iron-gate"],["zombie-flag","iron-gate","zombie-2","zombie-1","zombie-1","zombie-2","zombie-3","iron-gate","rugby","pole-vault","pole-vault"],["zombie-flag","rugby","zombie-2","zombie-1","zombie-2","zombie-2","iron-gate","iron-gate","rugby","pole-vault","rugby","zombie-boom"],["zombie-flag","iron-gate","zombie-2","zombie-2","zombie-3","zombie-3","iron-gate","newspaper","iron-gate","iron-gate","newspaper","rugby"],["zombie-flag","newspaper","newspaper","pole-vault","pole-vault","pole-vault","newspaper","pole-vault","pole-vault","pole-vault","rugby","rugby"],["zombie-flag","rugby","rugby","rugby","rugby","rugby","rugby","rugby","rugby","zombie-boom","rugby","zombie-boom","rugby","zombie-boom","rugby"],["zombie-flag","zombie-2","zombie-3","iron-gate","pole-vault","newspaper","newspaper","pole-vault","rugby","rugby","zombie-dance"],["zombie-flag","iron-gate","iron-gate","iron-gate","iron-gate","zombie-boom","zombie-boom","iron-gate","rugby","rugby","rugby","zombie-dance"],["zombie-flag","zombie-flag","zombie-flag","zombie-flag","zombie-flag","zombie-flag","zombie-flag","zombie-flag","zombie-flag","zombie-flag"],["zombie-flag","zombie-3","zombie-3","zombie-3","zombie-3","godzilla","zombie-3","zombie-3","zombie-3","zombie-3"],["zombie-flag","zombie-3","zombie-dance","zombie-3","ice-car","iron-gate","iron-gate","rugby","rugby","rugby","zombie-dance"],["zombie-flag","zombie-3","zombie-2","zombie-1","rabbish","rabbish-2","rabbish","zombie-1","zombie-2","zombie-3"],["zombie-flag","zombie-2","zombie-3","pole-vault","iron-gate","rugby","pole-vault","zombie-dance","zombie-2","pole-vault","ice-car","ice-car"],["zombie-flag","ice-car","zombie-1","ice-car","zombie-2","ice-car","zombie-3","ice-car","zombie-2","ice-car","zombie-1","ice-car"],["zombie-flag","rabbish","zombie-dance","pole-vault","ice-car","zombie-dance","ice-car","pole-vault","rabbish","afu","rabbish"],["zombie-flag","zombie-3","zombie-3","zombie-dance","zombie-dance","godzilla","zombie-dance","zombie-dance","zombie-3","zombie-3"],["zombie-flag","rabbish","ice-car","zombie-dance","rabbish-2","rabbish-2","rabbish","zombie-dance","zombie-3","rabbish"],["zombie-flag","zombie-1","zombie-2","zombie-3","iron-gate","rugby","newspaper","zombie-dance","pole-vault","ice-car","afu","fulisha","kunkun","rabbish","rabbish-2","zombie-boom","godzilla"],["zombie-flag","iron-gate","rabbish","rabbish","rabbish-2","rabbish","rabbish","iron-gate"],["zombie-flag","afu","rabbish","pole-vault","rugby","godzilla","rabbish-2","fulisha","fulisha","iron-gate"],["zombie-flag","zombie-boom","zombie-boom","zombie-boom","zombie-boom","zombie-boom","zombie-boom","zombie-boom","zombie-boom","zombie-boom","zombie-boom"],["zombie-flag","ice-car","ice-car","ice-car","ice-car","ice-car","ice-car","ice-car","ice-car","ice-car"],["zombie-flag","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla"]]],he=[{start:[{x:0,y:5,x_y:3,num:73}],map:[{2:2,4:3,6:2,8:3,18:4,20:3,22:4,24:3,26:4,28:1,30:4,32:1,34:4,36:1,46:2,48:1,51:2,53:3,58:2,61:3,67:4,70:1}],enemyArr:[["ice-car"]]},{start:[{x:7,y:5,x_y:1,num:23},{x:11,y:5,x_y:3,num:23},{x:7,y:6,x_y:1,num:22},{x:11,y:6,x_y:3,num:22}],map:[{1:2,2:1,3:2,4:1,5:2,6:1,7:2,8:1,9:2,10:3,13:4,14:3,15:4,16:3,17:4,18:3,19:4,20:3,22:4},{1:2,2:3,3:2,4:3,5:2,6:3,7:2,8:3,9:2,10:1,13:4,14:1,15:4,16:1,17:4,18:1,19:4,20:1,22:4},{1:4,2:1,3:4,4:1,5:4,6:1,7:4,8:1,9:4,10:3,13:2,14:3,15:2,16:3,17:2,18:3,19:2,20:3,22:2},{1:4,2:3,3:4,4:3,5:4,6:3,7:4,8:3,9:4,10:1,13:2,14:1,15:2,16:1,17:2,18:1,19:2,20:1,22:2}],end:{x:9,y:6}},{start:[{x:1,y:1,x_y:4,num:26},{x:18,y:1,x_y:4,num:27},{x:1,y:10,x_y:2,num:27},{x:18,y:10,x_y:2,num:28}],map:[{3:3,8:2,9:1,10:2,11:1,12:2,13:1,14:2,16:3,18:4,19:3,20:4,21:3,22:4,23:3,24:4,25:3},{3:1,8:2,9:3,10:2,11:3,12:2,13:3,14:2,16:1,18:4,19:1,20:4,21:1,22:4,23:1,24:4,25:1},{3:3,8:4,9:1,10:4,11:1,12:4,13:1,14:4,16:3,18:2,19:3,20:2,21:3,22:2,23:3,24:2,25:3,26:2},{3:1,8:4,9:3,10:4,11:3,12:4,13:3,14:4,16:1,18:2,19:1,20:2,21:1,22:2,23:1,24:2,25:1,27:2}],end:{x:9,y:5}},{start:[{x:13,y:5,x_y:3,num:39},{x:13,y:6,x_y:3,num:38}],map:[{4:2,8:1,15:4,18:1,21:2,24:1,31:4,34:3,38:4},{4:4,8:1,15:2,18:1,21:4,24:1,31:2,34:3}],end:{x:5,y:6}},{start:[{x:1,y:5,x_y:3,num:34},{x:1,y:6,x_y:3,num:33}],map:[{2:2,4:3,5:4,6:3,7:4,8:3,10:2,13:3,14:4,15:3,16:4,17:3,18:4,19:3,21:2,25:3,26:4,27:3,28:4,29:3,30:4,31:3,32:4,33:3},{2:4,4:3,5:2,6:3,7:2,8:3,10:4,13:3,14:2,15:3,16:2,17:3,18:2,19:3,21:4,25:3,26:2,27:3,28:2,29:3,30:2,31:3}],end:{x:18,y:6}},{start:[{x:1,y:1,x_y:4,num:32},{x:17,y:1,x_y:4,num:32}],map:[{9:3,11:2,20:3,21:4,26:3,28:2,29:3,31:4},{9:1,11:2,20:1,21:4,26:1,28:2,29:1,31:4}],end:{x:9,y:7}},{start:[{x:1,y:1,x_y:4,num:36},{x:4,y:1,x_y:4,num:27}],map:[{1:3,2:4,3:3,4:4,5:3,6:4,7:3,8:4,9:3,10:4,11:3,12:4,13:3,14:4,15:3,16:4,17:3,19:2,20:3,21:2,22:3,23:2,24:3,25:2,26:3,27:2,28:3,29:2,30:3,31:2,32:3,33:2,34:3,35:2},{1:3,2:4,3:3,4:4,5:3,6:4,7:3,8:4,9:3,10:4,11:3,13:2,14:3,15:2,16:3,17:2,18:3,19:2,20:3,21:2,22:3,23:2,24:3,25:2,26:3}],end:{x:19,y:1}},{start:[{x:1,y:5,x_y:2,num:48},{x:9,y:1,x_y:3,num:36},{x:5,y:10,x_y:3,num:37}],map:[{3:3,5:4,8:3,23:4,26:1,41:4,44:1,46:2},{8:4,14:1,29:4,32:1,34:2},{12:2,15:1,30:4,33:1,35:2}],end:{x:1,y:7}},{start:[{x:9,y:1,x_y:4,num:49}],map:[{1:1,3:4,4:1,6:4,7:1,11:4,12:3,16:4,17:3,19:4,20:3,22:4,24:3,25:2,27:3,29:2,30:3,32:2,33:3,37:2,38:1,42:2,43:1,45:2,46:1,48:2}],end:{x:10,y:1}},{start:[{x:18,y:10,x_y:1,num:57}],map:[{16:2,18:3,19:2,21:3,22:2,24:3,25:2,27:3,28:2,29:3,31:4,32:3,33:4,35:3,36:4,38:3,39:4,41:3,42:4,43:3,44:2,45:3,46:2,48:3,49:2,51:3,52:2,53:3,54:2,55:3,56:2}],end:{x:18,y:1}},{start:[{x:3,y:3,x_y:4,num:38},{x:16,y:3,x_y:4,num:37}],map:[{1:3,2:4,3:3,5:2,6:3,7:2,8:3,9:2,10:3,11:2,13:1,21:4,30:3},{1:1,2:4,3:1,5:2,6:1,7:2,8:1,9:2,10:1,11:2,13:3,21:4,30:1}],end:{x:10,y:10}},{start:[{x:15,y:4,x_y:4,num:108}],map:[{1:1,15:1,45:1,87:1,105:1,3:2,21:2,63:2,93:2,107:2,6:3,28:3,72:3,98:3,10:4,36:4,80:4,102:4}]},{start:[{x:8,y:5,x_y:2,num:66}],map:[{2:1,4:2,5:1,7:2,8:1,12:4,16:3,17:4,19:3,21:4,23:3,25:4,26:3,28:4,29:3,30:4,31:3,34:2,35:3,36:2,37:3,39:2,40:3,42:2,44:3,46:2,48:3,49:2,53:1,57:4,58:1,60:4,61:1,63:4}]},{start:[{x:1,y:1,x_y:3,num:58}],map:[{5:4,9:1,14:4,19:3,34:2,35:1,40:2,44:3,49:2,53:1}]},{start:[{x:19,y:5,x_y:1,num:57}],map:[{13:1,20:1,8:2,44:2,30:3,42:3,48:3,15:4,28:4,38:4}]},{start:[{x:0,y:10,x_y:3,num:68}],map:[{2:2,3:3,4:2,5:3,6:2,7:3,8:2,9:3,10:2,11:3,12:2,13:3,14:2,15:3,16:2,17:3,18:2,19:3,20:2,21:3,23:4,24:3,25:4,26:3,27:4,28:3,29:4,30:3,31:4,32:3,33:4,34:3,35:4,37:1,40:2,41:1,42:2,43:1,44:2,45:1,46:2,47:1,49:4,50:1,51:4,52:1,53:4,54:1,55:4,56:1,58:4,60:3}]},{start:[{x:11,y:10,x_y:2,num:50}],map:[{3:3,10:2,12:1,14:2,15:1,17:2,18:1,20:2,21:1,22:2,23:1,26:4,27:1,28:4,29:1,31:4,32:1,34:4,35:1,37:4,39:3,46:4}]},{start:[{x:14,y:3,x_y:4,num:84}],map:[{1:1,2:4,4:3,7:2,8:3,9:2,10:3,12:2,14:1,16:2,17:1,19:2,20:1,22:4,23:1,24:4,25:1,26:4,28:1,29:4,30:1,32:2,35:1,36:2,37:1,38:2,39:1,44:4,46:1,47:4,52:3,53:4,57:3,59:2,63:3,65:4,69:3,71:2,75:3,79:4,81:3}]},{start:[{x:3,y:1,x_y:4,num:25},{x:7,y:1,x_y:4,num:23},{x:11,y:1,x_y:4,num:17},{x:15,y:1,x_y:4,num:13}],map:[{3:1,5:4,10:3},{5:1,8:4,11:3},{2:1,4:4,7:3,9:4,12:3},{3:1,5:4,10:3}],end:{x:17,y:10}}],de={experience:[{start:[{x:1,y:1,x_y:4,num:39},{x:18,y:1,x_y:1,num:32},{x:18,y:9,x_y:4,num:28},{x:2,y:9,x_y:2,num:30}],map:[{3:3,5:2,9:3,11:4,15:3,17:2,21:3,23:4,31:3,33:2},{4:4,6:3,11:4,12:1,15:4,17:3,20:4,21:1,28:2},{1:1,3:2,5:1,7:4,9:1,16:2,17:3,19:2,20:3,22:2},{1:1,3:4,7:3,11:2,15:3,20:4,22:3,24:2}],end:{x:11,y:2},towerArr:[{tname:"aixi",x:4,y:6},{tname:"aixi",x:13,y:5},{tname:"aixi",x:13,y:9},{tname:"lanbo",x:3,y:8},{tname:"lanbo",x:3,y:9},{tname:"lanbo",x:4,y:3},{tname:"lanbo",x:4,y:4},{tname:"lanbo",x:14,y:4},{tname:"lanbo",x:14,y:5},{tname:"lanbo",x:14,y:8},{tname:"huonan",x:8,y:6},{tname:"huonan",x:8,y:5},{tname:"huonan",x:10,y:6},{tname:"huonan",x:10,y:5},{tname:"delaiwen",x:0,y:2},{tname:"delaiwen",x:0,y:6},{tname:"ez",x:19,y:11},{tname:"ez",x:17,y:0},{tname:"twitch",x:7,y:8},{tname:"twitch",x:13,y:4},{tname:"twitch",x:15,y:10},{tname:"jin",x:10,y:8},{tname:"jin",x:10,y:7},{tname:"delaiwen",x:6,y:10},{tname:"delaiwen",x:6,y:11},{tname:"huonan",x:14,y:2},{tname:"ejiate",x:15,y:2}],enemyArr:[["zombie-flag","godzilla","zombie-boom","godzilla","zombie-boom","rabbish-2","rabbish","rabbish-2","ice-car","ice-car","fulisha","fulisha","zombie-boom","kunkun","kunkun","zombie-dance","zombie-dance","afu","pole-vault","newspaper","rugby","iron-gate","zombie-3","zombie-2","zombie-1"],["zombie-flag","zombie-dance","rabbish-2","zombie-dance","rabbish-2","zombie-dance","rabbish-2","zombie-dance","rabbish-2","zombie-dance","rabbish-2","zombie-dance","rabbish-2"],["zombie-flag","fulisha","rabbish-2","fulisha","rabbish-2","fulisha","rabbish-2","fulisha","rabbish-2","fulisha","rabbish-2","fulisha","rabbish-2"],["zombie-flag","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla","godzilla"],["zombie-flag","kunkun","rabbish-2","kunkun","rabbish-2","kunkun","rabbish-2","kunkun","rabbish-2"],["zombie-flag","zombie-1","zombie-2","zombie-3","iron-gate","rugby","newspaper","zombie-dance","pole-vault","ice-car","afu","fulisha","kunkun","rabbish","rabbish-2","zombie-boom","godzilla"]]}],endless:[{start:[{x:0,y:5,x_y:3,num:74}],map:[{2:2,4:3,6:2,8:3,18:4,20:3,22:4,24:3,26:4,28:1,30:4,32:1,34:4,36:1,46:2,48:1,51:2,53:3,58:2,61:3,67:4,70:1}]}]};var be=(s=>(s.Normal="Normal",s.Experience="Experience",s.Endless="Endless",s))(be||{});const $=[{type:"Experience",typeIndex:0,...de.experience[0]}];for(let s=$.length,m=0;m<he.length;m++){const i={type:"Normal",enemyArr:Ce[0],...he[m]};$[s+m]=i}$.push({type:"Endless",typeIndex:0,enemyArr:Ce[0],start:de.endless[0].start,map:de.endless[0].map});const Ye={type:"Normal",enemyArr:[],start:[],map:[],disable:!0},Ze=["width","height"],Ke=Z({__name:"coverCanvas",props:{index:{}},setup(s){const m=s,i=fe(),e=I(Le("com-cover-canvas")),h=I(),t=Y({ctx:null,canvasInfo:{w:0,h:0},size:10,movePath:[]});oe(()=>{setTimeout(()=>{b(),S()},10),window.addEventListener("resize",y)}),_e(()=>{window.removeEventListener("resize",y)});const y=()=>{b(),setTimeout(()=>{z()},10)};function S(){!h.value||(t.ctx=h.value.getContext("2d"),v())}function b(){var f,_;const u=document.querySelector(`.${e.value}`),l=((f=u==null?void 0:u.clientWidth)!=null?f:0)*i.ratio,c=((_=u==null?void 0:u.clientHeight)!=null?_:0)*i.ratio;t.canvasInfo.w=l,t.canvasInfo.h=c,t.size=l/20}function v(){!$[m.index].start||($[m.index].start.forEach((u,l)=>{const c=JSON.parse(JSON.stringify(u)),{addRow:f,addCol:_}=He[c.x_y-1];c.x+=_,c.y+=f;const F=c.num;delete c.num;const k=[JSON.parse(JSON.stringify(c))];let D=c.x_y;for(let p=0;p<F;p++){const U=$[m.index].map[l][p];U&&(D=U),D%2?c.x+=D===3?1:-1:c.y+=D===4?1:-1,c.x_y=D,k.push(JSON.parse(JSON.stringify(c)))}t.movePath.push(k)}),setTimeout(()=>{z()},10))}async function x(){var c;const u=t.size;let l=(c=i.othOnloadImg)==null?void 0:c.start;l||(l=await ue(le.start)),$[m.index].start.forEach(f=>{let{x:_,y:F}=f;t.ctx.drawImage(l,_*u,F*u,u,u)})}async function z(){var F,k;let u=(F=i.othOnloadImg)==null?void 0:F.floor;u||(u=await ue(le.floor));const l=t.size;(k=t.ctx)==null||k.clearRect(0,0,t.canvasInfo.w,t.canvasInfo.h),t.movePath.forEach(D=>{var p;for(let U of D)(p=t.ctx)==null||p.drawImage(u,U.x*l,U.y*l,l,l)}),x();const c=$[m.index].end,f=c?c.x*l:t.movePath[0].at(-1).x*l,_=c?c.y*l:t.movePath[0].at(-1).y*l;ue(le.terminal).then(D=>{var p;(p=t.ctx)==null||p.drawImage(D,f-.35*l,_-1.42*l,l*1.8,l*2.48)})}return(u,l)=>(w(),M("div",{class:Fe(["com-cover-canvas",e.value])},[a("canvas",{ref_key:"canvasRef",ref:h,width:t.canvasInfo.w,height:t.canvasInfo.h,style:j({width:t.canvasInfo.w/r(i).ratio+"px",height:t.canvasInfo.h/r(i).ratio+"px"})},null,12,Ze)],2))}});const Qe=we(Ke,[["__scopeId","data-v-18109ca6"]]),ea=async s=>{const{id:m,...i}=s;return ge.updateUserProfile(m,i)},aa=async s=>{const{id:m,...i}=s;return ge.updateUserProfile(m,i)},oa=async s=>ge.uploadAvatar(s.userId,s.file),ta=(s,m,i)=>{m===""?i(new Error("\u8BF7\u8F93\u5165\u624B\u673A\u53F7")):(/^1(3|4|5|6|7|8|9)\d{9}$/.test(m)||i(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7")),i())};function sa(s){const m=typeof s;return s!==null&&(m==="object"||m==="function")}const P=s=>(ke("data-v-6cf069b6"),s=s(),$e(),s),na=P(()=>a("div",{class:"drawer-header"},[a("h4",null,"\u4E2A\u4EBA\u4FE1\u606F\u8BBE\u7F6E")],-1)),ia={class:"form-container"},ua={class:"avatar-section"},la=P(()=>a("label",{class:"form-label"},"\u5934\u50CF",-1)),ra={class:"avatar-upload-container"},ca={key:0,class:"avatar-placeholder"},ma=P(()=>a("span",{class:"iconfont icon-user"},null,-1)),da=P(()=>a("span",null,"\u70B9\u51FB\u4E0A\u4F20\u5934\u50CF",-1)),ba=[ma,da],ga={key:1,class:"avatar-uploading"},fa=P(()=>a("span",{class:"uploading-text"},"\u4E0A\u4F20\u4E2D...",-1)),va=["src"],pa=P(()=>a("div",{class:"avatar-tips"},[a("p",null,"\u652F\u6301JPG\u3001PNG\u683C\u5F0F\uFF0C\u6587\u4EF6\u5927\u5C0F\u4E0D\u8D85\u8FC75MB")],-1)),ya={class:"form-section"},ha=P(()=>a("h5",{class:"section-title"},"\u57FA\u672C\u4FE1\u606F",-1)),za=P(()=>a("span",{class:"iconfont icon-user input-icon"},null,-1)),xa=P(()=>a("span",{class:"iconfont icon-home input-icon"},null,-1)),_a=P(()=>a("span",{class:"iconfont icon-user input-icon"},null,-1)),Fa={class:"gender-options"},Ea={class:"gender-option"},Ia=P(()=>a("span",{class:"radio-text"},"\u7537",-1)),Ba={class:"gender-option"},wa=P(()=>a("span",{class:"radio-text"},"\u5973",-1)),Ca={class:"gender-option"},Aa=P(()=>a("span",{class:"radio-text"},"\u4FDD\u5BC6",-1)),Da=Z({__name:"userInfo",props:{visible:{type:Boolean,default:!1,require:!0}},emits:["update:visible"],setup(s,{emit:m}){var F,k,D,p,U,J,K,Q,W,q,C,g;const i=Ee(),e=Y({avatar:(k=(F=i.userInfo)==null?void 0:F.avatar)!=null?k:"",name:(p=(D=i.userInfo)==null?void 0:D.name)!=null?p:"",phone:(J=(U=i.userInfo)==null?void 0:U.phone)!=null?J:"",email:(Q=(K=i.userInfo)==null?void 0:K.email)!=null?Q:"",gender:(q=(W=i.userInfo)==null?void 0:W.gender)!=null?q:"",bio:(g=(C=i.userInfo)==null?void 0:C.bio)!=null?g:""}),h=I(),t=I(!1),y=(o,n)=>{var d;!((d=i.userInfo)!=null&&d.id)||(h.value&&clearTimeout(h.value),h.value=setTimeout(async()=>{var A;if(!t.value){t.value=!0;try{const V={};o==="username"?V.username=n:o==="avatar"?V.avatar_url=n:V[o]=n,await aa({id:((A=i.userInfo)==null?void 0:A.id)||"",...V}),console.log(`\u81EA\u52A8\u4FDD\u5B58 ${o} \u6210\u529F`)}catch(V){console.error("\u81EA\u52A8\u4FDD\u5B58\u5931\u8D25:",V)}finally{t.value=!1}}},2e3))},S=I(),b=I(!1),v=I(""),x=I(0),z=I(),u=Y({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u59D3\u540D",trigger:"blur"},{min:2,max:20,message:"\u59D3\u540D\u5E94\u57282-20\u4F4D\u4E4B\u95F4",trigger:"blur"}],phone:[{validator:ta,trigger:"blur"}],email:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1",trigger:"blur"},{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:"blur"}]}),l=async o=>{var d,A,V;const n=o.target;if(n.files&&n.files[0]){const O=n.files[0];if(!O.type.startsWith("image/")){N.error("\u8BF7\u9009\u62E9\u56FE\u7247\u6587\u4EF6");return}if(O.size>5*1024*1024){N.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC75MB");return}b.value=!0,x.value=0;const ve=new FileReader;ve.onload=H=>{var T;v.value=(T=H.target)==null?void 0:T.result},ve.readAsDataURL(O);try{const H=setInterval(()=>{x.value<90&&(x.value+=Math.random()*20)},100);console.log("\u5F00\u59CB\u4E0A\u4F20\u5934\u50CF:",{fileName:O.name,fileSize:O.size,fileType:O.type,userId:(d=i.userInfo)==null?void 0:d.id});const T=await oa({userId:((A=i.userInfo)==null?void 0:A.id)||"",file:O});if(clearInterval(H),x.value=100,T.code===200)N.success("\u5934\u50CF\u4E0A\u4F20\u6210\u529F"),v.value=T.data.url,i.userInfo&&(i.userInfo.avatar=T.data.url,i.userInfo.avatar_url=T.data.url),console.log("\u5934\u50CF\u4E0A\u4F20\u6210\u529F:",T.data);else{const te=((V=T.data)==null?void 0:V.message)||"\u4E0A\u4F20\u5931\u8D25";N.error(te),console.error("\u5934\u50CF\u4E0A\u4F20\u5931\u8D25:",T.data),(te.includes("\u5B58\u50A8\u6876")||te.includes("\u6743\u9650"))&&N({message:"\u8BF7\u68C0\u67E5Supabase\u5B58\u50A8\u6876\u914D\u7F6E\uFF0C\u6216\u67E5\u770B\u63A7\u5236\u53F0\u83B7\u53D6\u8BE6\u7EC6\u4FE1\u606F",type:"warning",duration:5e3})}}catch(H){console.error("\u5934\u50CF\u4E0A\u4F20\u9519\u8BEF:",H),N.error("\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}finally{b.value=!1,setTimeout(()=>{x.value=0},1e3)}}},c=async()=>{var o;(o=S.value)==null||o.validate(async n=>{var d;if(n)try{const A=await ea({id:i.userInfo.id,username:e.name,phone:e.phone,email:e.email,gender:e.gender,bio:e.bio,avatar_url:v.value||e.avatar});A.code===200&&A.data?(i.userInfo=A.data,N.success("\u4E2A\u4EBA\u4FE1\u606F\u66F4\u65B0\u6210\u529F")):N.error(((d=A.data)==null?void 0:d.message)||"\u66F4\u65B0\u5931\u8D25")}catch(A){console.log("error: ",A),N.error("\u66F4\u65B0\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}})};R(()=>e.name,o=>{var n;o!==((n=i.userInfo)==null?void 0:n.name)&&y("username",o)}),R(()=>e.phone,o=>{var n;o!==((n=i.userInfo)==null?void 0:n.phone)&&y("phone",o)}),R(()=>e.email,o=>{var n;o!==((n=i.userInfo)==null?void 0:n.email)&&y("email",o)}),R(()=>e.gender,o=>{var n;o!==((n=i.userInfo)==null?void 0:n.gender)&&y("gender",o)}),R(()=>e.bio,o=>{var n;o!==((n=i.userInfo)==null?void 0:n.bio)&&y("bio",o)}),R(()=>v.value,o=>{var n;o&&o!==((n=i.userInfo)==null?void 0:n.avatar)&&y("avatar",o)});const f=()=>{const o=i.userInfo;e.name=o.name||"",e.phone=o.phone||"",e.email=o.email||"",e.gender=o.gender||"",e.bio=o.bio||"",v.value=o.avatar||""},_=()=>{const o=i.userInfo;e.avatar=o.avatar||"",e.name=o.name||"",e.phone=o.phone||"",e.email=o.email||"",e.gender=o.gender||"",e.bio=o.bio||"",v.value=o.avatar||""};return(o,n)=>(w(),G(r(Ie),{modelValue:s.visible,direction:"ltr",size:600,onOpen:_,onClose:n[8]||(n[8]=d=>m("update:visible",!1)),class:"user-info-drawer"},{header:B(()=>[na]),default:B(()=>[a("div",ia,[E(r(De),{ref_key:"userFormRef",ref:S,model:e,rules:u,"hide-required-asterisk":"","label-position":"top",class:"user-form"},{default:B(()=>[a("div",ua,[la,a("div",ra,[a("div",{class:"avatar-upload",onClick:n[0]||(n[0]=d=>{var A;return!b.value&&((A=z.value)==null?void 0:A.click())})},[a("input",{ref_key:"avatarInput",ref:z,type:"file",accept:"image/*",onChange:l,style:{display:"none"}},null,544),!v.value&&!b.value?(w(),M("div",ca,ba)):b.value?(w(),M("div",ga,[E(r(Ae),{type:"circle",percentage:x.value,width:80,"stroke-width":6},null,8,["percentage"]),fa])):(w(),M("img",{key:2,src:v.value,class:"avatar-preview",alt:"\u7528\u6237\u5934\u50CF"},null,8,va))]),pa])]),a("div",ya,[ha,E(r(X),{label:"\u59D3\u540D",prop:"name"},{default:B(()=>[E(r(ee),{modelValue:e.name,"onUpdate:modelValue":n[1]||(n[1]=d=>e.name=d),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u59D3\u540D",maxlength:"20","show-word-limit":"",class:"custom-input"},{prefix:B(()=>[za]),_:1},8,["modelValue"])]),_:1}),E(r(X),{label:"\u624B\u673A\u53F7\u7801",prop:"phone"},{default:B(()=>[E(r(ee),{modelValue:e.phone,"onUpdate:modelValue":n[2]||(n[2]=d=>e.phone=d),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u624B\u673A\u53F7\u7801",maxlength:"11",class:"custom-input"},{prefix:B(()=>[xa]),_:1},8,["modelValue"])]),_:1}),E(r(X),{label:"\u90AE\u7BB1",prop:"email"},{default:B(()=>[E(r(ee),{modelValue:e.email,"onUpdate:modelValue":n[3]||(n[3]=d=>e.email=d),type:"email",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1",class:"custom-input"},{prefix:B(()=>[_a]),_:1},8,["modelValue"])]),_:1}),E(r(X),{label:"\u6027\u522B"},{default:B(()=>[a("div",Fa,[a("label",Ea,[se(a("input",{type:"radio",name:"gender","onUpdate:modelValue":n[4]||(n[4]=d=>e.gender=d),value:"male"},null,512),[[ne,e.gender]]),Ia]),a("label",Ba,[se(a("input",{type:"radio",name:"gender","onUpdate:modelValue":n[5]||(n[5]=d=>e.gender=d),value:"female"},null,512),[[ne,e.gender]]),wa]),a("label",Ca,[se(a("input",{type:"radio",name:"gender","onUpdate:modelValue":n[6]||(n[6]=d=>e.gender=d),value:"other"},null,512),[[ne,e.gender]]),Aa])])]),_:1}),E(r(X),{label:"\u4E2A\u4EBA\u7B80\u4ECB"},{default:B(()=>[E(r(ee),{modelValue:e.bio,"onUpdate:modelValue":n[7]||(n[7]=d=>e.bio=d),type:"textarea",rows:3,placeholder:"\u8BF7\u7B80\u8981\u4ECB\u7ECD\u4E00\u4E0B\u81EA\u5DF1",maxlength:"200","show-word-limit":"",class:"custom-textarea"},null,8,["modelValue"])]),_:1})]),a("div",{class:"button-group"},[a("button",{type:"button",class:"secondary-button",onClick:f}," \u91CD\u7F6E "),a("button",{type:"button",class:"primary-button",onClick:c}," \u4FDD\u5B58\u4FE1\u606F ")])]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"]))}});const ka=we(Da,[["__scopeId","data-v-6cf069b6"]]),$a={class:"selectLevelPop-area"},Sa={class:"card"},Pa={key:0,class:"card-selected"},Ma={class:"card-bg"},Va={key:0,class:"card-disable iconfont icon-disablecase"},Na={class:"card-level"},Ua=Z({__name:"selectLevelPop",props:{visible:{type:Boolean,default:!1,require:!0}},emits:["update:visible","switchMapLevel"],setup(s,{emit:m}){const i=fe(),e=Y({items:[],pageNum:1,pageSize:20}),h=({pageNum:b,pageSize:v})=>{const x=(b-1)*v,z=$.slice(x,x+v),u=z.length;for(let l=0;l<v-u;l++)z.push(Ye);e.items=z,e.pageNum=b,e.pageSize=v},t=()=>{const b=(e.pageNum-1)*e.pageSize;e.items=$.slice(b,b+e.pageSize)};oe(()=>{t()});const y=b=>(e.pageNum-1)*e.pageSize+b,S=b=>{switch($[b].type){case be.Endless:return"\u534D";case be.Experience:return"\u8BD5\u73A9";default:return b}};return(b,v)=>(w(),G(r(Ie),{modelValue:s.visible,class:"selectLevelPop","with-header":!1,size:"50vh",onClose:v[1]||(v[1]=x=>m("update:visible",!1))},{default:B(()=>[a("div",$a,[E(Ge,{"list-length":r($).length,"init-cart-num":r(i).mapLevel,onOnPageChange:h,"card-add-deg":3},{default:B(()=>[(w(!0),M(Be,null,Se(e.items,(x,z)=>(w(),G(Oe,{key:y(z),index:z,onOnClick:()=>{r($)[y(z)]&&(m("switchMapLevel",y(z)),m("update:visible",!1))}},{default:B(()=>[a("div",Sa,[r(i).mapLevel===y(z)?(w(),M("div",Pa)):L("",!0),a("div",Ma,[E(Qe,{index:y(z)},null,8,["index"]),r($)[y(z)]?L("",!0):(w(),M("div",Va))]),a("div",Na,me(S(z)),1)])]),_:2},1032,["index","onOnClick"]))),128))]),_:1},8,["list-length","init-cart-num"]),a("div",{class:"selectLevelPop-close iconfont icon-close",onClick:v[0]||(v[0]=x=>m("update:visible",!1))})])]),_:1},8,["modelValue"]))}});const re="legendTD-circle",ze=2*Math.PI,ce=-Math.PI/2,xe=100,Ta={value:ae(0),size:ae(100),speed:ae(60),color:ie("#68baf5"),layerColor:ie("#F6F6F6"),lineCap:ie("round"),strokeWidth:ae(6),clockwise:We,text:String,fill:String},Ra=Z({props:Ta,emits:["onChange"],setup(s,m){const{emit:i,slots:e}=m,h=I(),t=Y({ctx:void 0,curVal:0,curColor:"",timer:void 0,ratio:1}),y=I(!1);R(()=>s.value,u=>{z()}),R(()=>s.color,()=>{v(),b(t.curVal)}),R(()=>s.size,()=>{b(t.curVal)});const S=(u,l,c,f)=>{const _=s.size*t.ratio,F=s.strokeWidth*t.ratio,k=_/2,D=k-F/2,p=t.ctx;p.strokeStyle=u,p.lineWidth=F,p.lineCap=s.lineCap,p.beginPath(),p.arc(k,k,D,l,c,!s.clockwise),p.stroke(),f&&(p.fillStyle=f,p.fill())},b=u=>{var f;const l=s.size*t.ratio;(f=t.ctx)==null||f.clearRect(0,0,l,l),S(s.layerColor,0,ze,s.fill);const c=Xe(u,0,xe);if(c!==0){const _=ze*(c/100),F=s.clockwise?ce+_:3*Math.PI-(ce+_);S(t.curColor,ce,F)}},v=()=>{var l;const u=s.color;if(sa(u)){const c=u,f=Object.keys(u).sort((_,F)=>parseFloat(_)-parseFloat(F));t.curColor=c[(l=f.at(-1))!=null?l:""]}else t.curColor=u},x=()=>{t.timer!==void 0&&(cancelAnimationFrame(t.timer),t.timer=void 0)},z=()=>{const u=s.value;if(s.speed<=0||s.speed>1e3){b(u);return}x();const l=s.speed/xe,c=()=>{const f=t.curVal;Math.abs(f-u)<l?t.curVal=u:t.curVal+=(f<u?1:-1)*l,b(t.curVal)};(function f(){c(),t.curVal!==u?t.timer=requestAnimationFrame(f):(i("onChange",t.curVal),x())})()};return oe(()=>{(()=>{t.ctx=h.value.getContext("2d"),t.ratio=window.devicePixelRatio||1,y.value=!0,v(),z()})()}),_e(()=>{x()}),()=>{var u,l;return E("div",Pe({class:re},s),[E("canvas",{ref:h,class:`${re}-canvas`,width:s.size*t.ratio,height:s.size*t.ratio,style:{width:s.size+"px",height:s.size+"px"}},null),E("div",{class:`${re}-text`},[(l=s.text)!=null?l:(u=e==null?void 0:e.default)==null?void 0:u.call(e)])])}}});const La={class:"avatar game-logo"},Oa={key:0,class:"user-avatar"},Ga=["src"],Wa=a("div",{class:"user-avatar-ring"},null,-1),qa={key:1,class:"logo-container"},ja=a("div",{class:"bg-glow"},null,-1),Ja=a("div",{class:"outer-ring"},null,-1),Ha=a("div",{class:"inner-ring"},null,-1),Xa={class:"center-sphere"},Ya=a("div",{class:"core-gradient"},null,-1),Za={class:"game-icon"},Ka=["src"],Qa=a("div",{class:"light-dot dot-1"},null,-1),eo=a("div",{class:"light-dot dot-2"},null,-1),ao=a("div",{class:"light-dot dot-3"},null,-1),oo=a("div",{class:"light-dot dot-4"},null,-1),to=a("div",{class:"orbit-line"},null,-1),so={key:2,class:"fallback-logo"},no=a("div",{class:"fallback-content"},[a("i",{class:"fas fa-gamepad"})],-1),io=[no],bo=Z({__name:"userBall",props:{itemsNum:{default:3}},emits:["switchMapLevel","reStart"],setup(s,{emit:m}){const i=s;Me(C=>({"081b30d7":f().primary,d9813956:f().accent,"922f6a50":f().glow,a9b599ee:f().secondary}));const e=fe(),h=Ee(),t=Ve(),y=I(window.innerHeight>window.innerWidth?-1:1),S=I(!1),b=I(!1),v=I(!1),x=I(!1),z=I(e.progress<100),u=I(),l=I(!1),c=()=>{console.warn("\u6E38\u620F\u56FE\u6807\u52A0\u8F7D\u5931\u8D25:",F.value),k()?console.log("\u5C1D\u8BD5\u4E0B\u4E00\u4E2A\u56FE\u6807\u8DEF\u5F84:",F.value):(console.warn("\u6240\u6709\u56FE\u6807\u8DEF\u5F84\u90FD\u5931\u8D25\uFF0C\u4F7F\u7528\u5907\u7528\u56FE\u6807"),l.value=!0)},f=()=>({primary:"#667eea",secondary:"#764ba2",accent:"#f093fb",glow:"rgba(102, 126, 234, 0.6)",core:"#ffd700"}),_=["/src/assets/img/myGame.png","/assets/img/myGame.png","./src/assets/img/myGame.png","./assets/img/myGame.png","/public/src/assets/img/myGame.png","/public/assets/img/myGame.png"],F=I(_[0]),k=()=>{const C=_.indexOf(F.value);return C<_.length-1?(F.value=_[C+1],!0):!1},D=Ne(()=>{let C=e.isMobile?"1rem":"50px";return{"--initial-position-top":C,[e.isMobile?"--initial-position-left":"--initial-position-right"]:C,"--z-index":"1000"}}),p=C=>{const g=e.isMobile?-40:-60,o=e.isMobile?100:80,n=(-g+o)/i.itemsNum,d=28*i.itemsNum*(e.isMobile?.7:1),A=-d*Math.cos((g+(C+1)*n)*Math.PI/180)*y.value,V=d*Math.sin((g+(C+1)*n)*Math.PI/180)*(y.value?1:0);return{transform:`translate(calc(-50% + ${A}px), calc(-50% + ${V}px))`,opacity:y.value?1:0}},U=C=>{y.value=C?-1:1,W()},J=()=>{h.userInfo?Re.confirm("\u60A8\u786E\u5B9A\u8981\u9000\u51FA\u767B\u5F55\u5417\uFF1F","\u9000\u51FA\u767B\u5F55",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{await h.logout(),N.info("\u767B\u5F55\u5DF2\u9000\u51FA"),t.push("/login")}):t.push("/login")},K=()=>{h.userInfo?S.value=!0:N.info("\u8BF7\u5148\u767B\u5F55")},Q=C=>{C>=100&&setTimeout(()=>{z.value=!1},400)},W=()=>{q(),u.value=setTimeout(()=>{y.value=0},3e3)},q=()=>{u.value&&(clearTimeout(u.value),u.value=void 0)};return oe(W),Ue(q),(C,g)=>(w(),M(Be,null,[E(r(qe),{magnetic:"x",style:j(D.value),onOnOffsetChange:g[4]||(g[4]=o=>y.value=0),onOnMagnetic:U},{default:B(()=>{var o,n;return[a("div",{class:Fe(["ball-wrap",{"ball-mobile":r(e).isMobile}]),onMouseenter:q,onMouseleave:W},[a("div",La,[(o=r(h).userInfo)!=null&&o.avatar?(w(),M("div",Oa,[a("img",{src:r(h).userInfo.avatar,alt:"\u7528\u6237\u5934\u50CF",class:"avatar-img"},null,8,Ga),Wa])):(w(),M("div",qa,[ja,Ja,Ha,a("div",Xa,[Ya,a("div",Za,[a("img",{src:F.value,alt:"\u5854\u9632\u8054\u76DF\u6E38\u620F\u56FE\u6807",class:"game-logo-img",onError:c},null,40,Ka)]),Qa,eo,ao,oo]),to])),!((n=r(h).userInfo)!=null&&n.avatar)&&l.value?(w(),M("div",so,io)):L("",!0)]),a("div",{class:"ball-item",style:j(p(0))},[a("div",{class:"ball-item-content",onClick:g[0]||(g[0]=d=>x.value=!0)},"\u5854\u9632\u9009\u62E9")],4),a("div",{class:"ball-item",style:j(p(1))},[a("div",{class:"ball-item-content",onClick:g[1]||(g[1]=d=>b.value=!0)},"\u6392\u884C\u699C")],4),i.itemsNum===4?(w(),M("div",{key:0,class:"ball-item",style:j(p(2))},[a("div",{class:"ball-item-content",onClick:g[2]||(g[2]=d=>v.value=!0)},"\u9009\u5173")],4)):L("",!0),a("div",{class:"ball-item",style:j(p(i.itemsNum-1))},[E(r(Te),{size:"small"},{dropdown:B(()=>[r(h).userInfo?(w(),G(r(ye),{key:0,onClick:K},{default:B(()=>[pe("\u4E2A\u4EBA\u4FE1\u606F")]),_:1})):L("",!0),E(r(ye),{onClick:J},{default:B(()=>[pe(me(r(h).userInfo?"\u9000\u51FA\u767B\u5F55":"\u53BB\u767B\u5F55"),1)]),_:1})]),default:B(()=>[a("div",{class:"ball-item-content",onClick:g[3]||(g[3]=()=>{r(h).userInfo||J()})},me(r(h).userInfo?"\u8BBE\u7F6E":"\u767B\u5F55"),1)]),_:1})],4),z.value?(w(),G(r(Ra),{key:1,class:"circle",value:Math.ceil(r(e).progress),"stroke-width":r(e).isMobile?4:6,speed:100,size:r(e).isMobile?62:90,"layer-color":"rgba(255,255,255,0.4)",onOnChange:Q},null,8,["value","stroke-width","size"])):L("",!0)],34)]}),_:1},8,["style"]),r(h).userInfo?(w(),G(ka,{key:0,visible:S.value,"onUpdate:visible":g[5]||(g[5]=o=>S.value=o)},null,8,["visible"])):L("",!0),E(je,{visible:b.value,"onUpdate:visible":g[6]||(g[6]=o=>b.value=o)},null,8,["visible"]),E(Je,{visible:x.value,"onUpdate:visible":g[7]||(g[7]=o=>x.value=o),onReStart:g[8]||(g[8]=o=>m("reStart"))},null,8,["visible"]),i.itemsNum===4?(w(),G(Ua,{key:1,visible:v.value,"onUpdate:visible":g[9]||(g[9]=o=>v.value=o),onSwitchMapLevel:g[10]||(g[10]=o=>m("switchMapLevel",o))},null,8,["visible"])):L("",!0)],64))}});export{Qe as C,be as L,bo as _,Ye as a,$ as l};
